<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üéÑ Merry Christmas Diana! üéÑ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600;700&family=Mountains+of+Christmas:wght@700&family=Cedarville+Cursive&display=swap');

:root {
    --christmas-red: #ff4d6d;
    --christmas-gold: #ffd700;
    --christmas-green: #2ecc71;
    --christmas-blue: #6dd5ed;
    --dark-bg: #0a192f;
    --light-bg: rgba(255, 255, 255, 0.1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    background: linear-gradient(135deg, #0a192f 0%, #1a365d 50%, #0a192f 100%);
    color: white;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
}

/* ANIMATED BACKGROUND */
.animated-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    overflow: hidden;
}

.floating-heart {
    position: absolute;
    font-size: 20px;
    animation: floatUp 20s linear infinite;
    opacity: 0.7;
}

.floating-star {
    position: absolute;
    font-size: 15px;
    animation: floatStar 25s linear infinite;
    opacity: 0.5;
}

@keyframes floatUp {
    0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 0.7;
    }
    90% {
        opacity: 0.7;
    }
    100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
    }
}

@keyframes floatStar {
    0% {
        transform: translateY(100vh) translateX(0) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 0.5;
    }
    90% {
        opacity: 0.5;
    }
    100% {
        transform: translateY(-100px) translateX(100px) rotate(720deg);
        opacity: 0;
    }
}

/* MUSIC CONTROL */
.music-control {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: linear-gradient(45deg, var(--christmas-red), var(--christmas-gold));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(255, 77, 109, 0.5);
    transition: all 0.3s;
    font-size: 1.2rem;
}

.music-control:hover {
    transform: scale(1.1) rotate(15deg);
    box-shadow: 0 8px 25px rgba(255, 77, 109, 0.7);
}

/* PAGES */
.page {
    position: absolute;
    width: 100%;
    height: 100%;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 30px;
    z-index: 10;
    overflow: hidden;
}

.page.active {
    display: flex;
    animation: pageIn 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes pageIn {
    from {
        opacity: 0;
        transform: scale(0.9) translateY(50px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* PAGE 1 - WELCOME */
#p1 h1 {
    font-family: 'Mountains of Christmas', cursive;
    font-size: 4.5rem;
    background: linear-gradient(45deg, var(--christmas-red), var(--christmas-gold));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin-bottom: 20px;
    text-shadow: 0 0 30px rgba(255, 77, 109, 0.3);
    animation: titleGlow 3s infinite alternate;
}

@keyframes titleGlow {
    0% {
        text-shadow: 0 0 20px rgba(255, 77, 109, 0.5);
    }
    100% {
        text-shadow: 0 0 30px rgba(255, 215, 0, 0.7), 0 0 40px rgba(255, 77, 109, 0.5);
    }
}

.christmas-tree {
    font-size: 120px;
    margin: 30px 0;
    animation: treeFloat 4s ease-in-out infinite;
    filter: drop-shadow(0 0 15px rgba(46, 204, 113, 0.5));
}

@keyframes treeFloat {
    0%, 100% {
        transform: translateY(0) rotate(0deg);
    }
    50% {
        transform: translateY(-20px) rotate(5deg);
    }
}

/* LOADER */
.loader-container {
    width: 80%;
    max-width: 400px;
    height: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    margin-top: 40px;
    overflow: hidden;
    position: relative;
}

.loader-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--christmas-red), var(--christmas-gold));
    border-radius: 10px;
    transition: width 0.5s ease;
    position: relative;
}

.loader-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

/* PAGE 2 - HEART TAP */
.heart-container {
    position: relative;
    margin: 40px 0;
}

.heart {
    font-size: 120px;
    cursor: pointer;
    animation: heartbeat 1.2s infinite;
    color: var(--christmas-red);
    filter: drop-shadow(0 0 20px rgba(255, 77, 109, 0.7));
    transition: transform 0.3s;
}

@keyframes heartbeat {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.2);
    }
}

/* PAGE 3 - NAME LOCK */
.lock-icon {
    font-size: 80px;
    margin: 20px 0;
    color: var(--christmas-gold);
    animation: lockSpin 3s infinite linear;
}

@keyframes lockSpin {
    0% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(180deg) scale(1.1); }
    100% { transform: rotate(360deg) scale(1); }
}

/* PAGE 4 - EMOTION SELECTION */
.emotion-buttons {
    display: flex;
    gap: 20px;
    margin: 40px 0;
    flex-wrap: wrap;
    justify-content: center;
}

.emotion-btn {
    width: 100px;
    height: 100px;
    border-radius: 20px;
    background: var(--light-bg);
    border: 2px solid transparent;
    font-size: 50px;
    cursor: pointer;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
}

.emotion-btn:hover {
    transform: translateY(-10px) scale(1.1);
    border-color: var(--christmas-gold);
    box-shadow: 0 15px 30px rgba(255, 215, 0, 0.2);
}

.emotion-btn::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transform: translateX(-100%);
    transition: transform 0.6s;
}

.emotion-btn:hover::after {
    transform: translateX(100%);
}

/* PAGE 5 - SPECIAL MESSAGE WITH SLIDER CONTROLS */
.message-slider-container {
    max-width: 800px;
    width: 90%;
    height: 500px;
    background: var(--light-bg);
    border-radius: 25px;
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    position: relative;
    overflow: hidden;
    margin: 20px;
}

.message-slider {
    width: 100%;
    height: 100%;
    overflow-y: auto;
    padding: 40px;
    scroll-behavior: smooth;
}

/* Custom scrollbar for message slider */
.message-slider::-webkit-scrollbar {
    width: 8px;
}

.message-slider::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
}

.message-slider::-webkit-scrollbar-thumb {
    background: linear-gradient(var(--christmas-red), var(--christmas-gold));
    border-radius: 10px;
}

.message-slider::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(var(--christmas-gold), var(--christmas-red));
}

.slider-controls {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 20;
}

.slider-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--light-bg);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: var(--christmas-gold);
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
}

.slider-btn:hover {
    background: rgba(255, 215, 0, 0.2);
    transform: scale(1.1);
    border-color: var(--christmas-gold);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
}

.slider-btn:active {
    transform: scale(0.95);
}

.slider-dots {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 20;
}

.slider-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    cursor: pointer;
    transition: all 0.3s;
}

.slider-dot.active {
    background: var(--christmas-gold);
    transform: scale(1.3);
    box-shadow: 0 0 10px var(--christmas-gold);
}

.slider-dot:hover {
    background: var(--christmas-red);
    transform: scale(1.2);
}

.typing-text {
    font-size: 1.4rem;
    line-height: 1.8;
    text-align: left;
    position: relative;
    z-index: 2;
    font-family: 'Dancing Script', cursive;
    color: white;
}

.message-line {
    margin-bottom: 25px;
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s forwards;
    padding-left: 20px;
    border-left: 3px solid var(--christmas-gold);
    transition: all 0.5s;
}

@keyframes fadeInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.typing-cursor {
    display: inline-block;
    width: 3px;
    height: 1.4em;
    background: var(--christmas-gold);
    margin-left: 5px;
    animation: blink 0.7s infinite;
    vertical-align: middle;
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

/* PAGE 6 - TIC TAC TOE */
.game-container {
    background: var(--light-bg);
    padding: 30px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    margin-top: 20px;
}

.board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-template-rows: repeat(3, 100px);
    gap: 12px;
    margin: 30px auto;
}

.cell {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 48px;
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
}

.cell:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
}

.cell.x::before {
    content: '‚ùå';
    animation: popIn 0.3s ease-out;
}

.cell.o::before {
    content: '‚≠ï';
    animation: popIn 0.3s ease-out;
}

@keyframes popIn {
    from {
        transform: scale(0);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}

/* PAGE 7 - FINAL MESSAGE WITH ADVANCED SLIDER */
.final-message-container {
    max-width: 900px;
    width: 95%;
    height: 600px;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 30px;
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    overflow: hidden;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
}

.final-message-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, var(--christmas-red), var(--christmas-gold), var(--christmas-blue));
}

.final-title {
    font-family: 'Mountains of Christmas', cursive;
    font-size: 3.5rem;
    color: var(--christmas-gold);
    margin-bottom: 30px;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    animation: titlePulse 2s infinite alternate;
    padding: 0 50px;
}

@keyframes titlePulse {
    from {
        transform: scale(1);
        text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }
    to {
        transform: scale(1.02);
        text-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 77, 109, 0.5);
    }
}

.message-slider-wrapper {
    position: relative;
    width: 100%;
    height: calc(100% - 120px);
    overflow: hidden;
}

.message-slides {
    display: flex;
    transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    height: 100%;
    width: 100%;
}

.message-slide {
    min-width: 100%;
    height: 100%;
    padding: 0 50px;
    overflow-y: auto;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* Scrollbar for message slides */
.message-slide::-webkit-scrollbar {
    width: 6px;
}

.message-slide::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

.message-slide::-webkit-scrollbar-thumb {
    background: rgba(255, 215, 0, 0.3);
    border-radius: 3px;
}

.message-slide::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 215, 0, 0.5);
}

.message-content {
    font-size: 1.5rem;
    line-height: 1.9;
    text-align: left;
    margin: 20px 0;
    font-family: 'Dancing Script', cursive;
}

.message-paragraph {
    margin-bottom: 30px;
    opacity: 0;
    transform: translateX(-30px);
    animation: slideInRight 1s forwards;
    padding-left: 25px;
    border-left: 3px solid var(--christmas-red);
    transition: all 0.5s;
}

@keyframes slideInRight {
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.message-paragraph:nth-child(1) { animation-delay: 0.2s; }
.message-paragraph:nth-child(2) { animation-delay: 0.4s; }
.message-paragraph:nth-child(3) { animation-delay: 0.6s; }
.message-paragraph:nth-child(4) { animation-delay: 0.8s; }
.message-paragraph:nth-child(5) { animation-delay: 1s; }
.message-paragraph:nth-child(6) { animation-delay: 1.2s; }
.message-paragraph:nth-child(7) { animation-delay: 1.4s; }
.message-paragraph:nth-child(8) { animation-delay: 1.6s; }

.advanced-slider-controls {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 25px;
    z-index: 20;
    background: rgba(0, 0, 0, 0.3);
    padding: 15px 25px;
    border-radius: 50px;
    backdrop-filter: blur(10px);
}

.advanced-slider-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--light-bg);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: var(--christmas-gold);
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.advanced-slider-btn:hover {
    background: rgba(255, 215, 0, 0.2);
    transform: scale(1.1);
    border-color: var(--christmas-gold);
    box-shadow: 0 0 25px rgba(255, 215, 0, 0.4);
}

.advanced-slider-btn:active {
    transform: scale(0.95);
}

.slide-indicator {
    font-size: 1.2rem;
    color: var(--christmas-gold);
    min-width: 80px;
    text-align: center;
    font-weight: 600;
}

.progress-bar {
    width: 200px;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    overflow: hidden;
    position: relative;
}

.progress-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--christmas-red), var(--christmas-gold));
    transition: width 0.5s ease;
    border-radius: 3px;
}

.keyboard-hint {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.6);
    text-align: center;
    background: rgba(0, 0, 0, 0.2);
    padding: 8px 15px;
    border-radius: 20px;
    backdrop-filter: blur(5px);
}

.signature {
    text-align: right;
    font-style: italic;
    font-weight: 600;
    color: var(--christmas-blue);
    margin-top: 40px;
    font-size: 1.8rem;
    opacity: 0;
    animation: fadeIn 1s 2s forwards;
}

@keyframes fadeIn {
    to { opacity: 1; }
}

/* BUTTONS */
.btn {
    padding: 16px 45px;
    border: none;
    border-radius: 50px;
    background: linear-gradient(45deg, var(--christmas-red), var(--christmas-gold));
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 25px;
    font-weight: 600;
    letter-spacing: 1px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(255, 77, 109, 0.3);
}

.btn:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(255, 77, 109, 0.5);
    background: linear-gradient(45deg, var(--christmas-gold), var(--christmas-red));
}

.btn:active {
    transform: translateY(0);
}

.btn::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: 0.6s;
}

.btn:hover::after {
    left: 100%;
}

/* INPUT STYLES */
.name-input {
    padding: 16px 25px;
    font-size: 1.2rem;
    border: none;
    border-radius: 15px;
    background: var(--light-bg);
    color: white;
    margin: 20px 0;
    width: 300px;
    max-width: 90%;
    backdrop-filter: blur(10px);
    border: 2px solid transparent;
    transition: all 0.3s;
    text-align: center;
}

.name-input:focus {
    outline: none;
    border-color: var(--christmas-gold);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    background: rgba(255, 255, 255, 0.15);
}

/* CONFETTI */
.confetti {
    position: absolute;
    width: 10px;
    height: 10px;
    opacity: 0;
    z-index: 999;
}

/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
    #p1 h1 { font-size: 3rem; }
    .christmas-tree { font-size: 80px; }
    .board { grid-template-columns: repeat(3, 80px); grid-template-rows: repeat(3, 80px); }
    .cell { font-size: 36px; }
    .final-title { font-size: 2.5rem; }
    .message-slider-container { height: 400px; }
    .final-message-container { height: 500px; }
    .message-content { font-size: 1.3rem; }
    .typing-text { font-size: 1.2rem; }
    .advanced-slider-controls { gap: 15px; padding: 10px 20px; }
    .advanced-slider-btn { width: 50px; height: 50px; font-size: 20px; }
    .progress-bar { width: 150px; }
}

@media (max-width: 480px) {
    .page { padding: 20px; }
    #p1 h1 { font-size: 2.5rem; }
    .christmas-tree { font-size: 60px; }
    .heart { font-size: 80px; }
    .emotion-btn { width: 70px; height: 70px; font-size: 35px; }
    .board { grid-template-columns: repeat(3, 70px); grid-template-rows: repeat(3, 70px); }
    .btn { padding: 14px 35px; font-size: 1rem; }
    .final-title { font-size: 2rem; padding: 0 20px; }
    .message-slide { padding: 0 20px; }
    .advanced-slider-controls { gap: 10px; padding: 8px 15px; }
    .advanced-slider-btn { width: 45px; height: 45px; font-size: 18px; }
    .progress-bar { width: 120px; }
    .keyboard-hint { font-size: 0.8rem; padding: 6px 12px; }
}
</style>
</head>

<body>

<!-- ANIMATED BACKGROUND -->
<div class="animated-bg" id="animatedBg"></div>

<!-- MUSIC CONTROL -->
<div class="music-control" id="musicToggle">
    <i class="fas fa-music"></i>
</div>

<audio id="bgMusic" loop>
    <source src="https://assets.mixkit.co/music/preview/mixkit-christmas-is-coming-1194.mp3" type="audio/mpeg">
</audio>

<!-- PAGE 1 - WELCOME -->
<div class="page active" id="p1">
    <h1>üéÑ Merry Christmas üéÑ</h1>
    <div class="christmas-tree">üéÑ</div>
    <h2 style="font-size: 2.5rem; color: var(--christmas-gold); margin-bottom: 10px;">For Diana</h2>
    <p style="opacity: 0.9; font-size: 1.2rem; max-width: 500px;">A magical digital gift created with love by Ayaz</p>
    
    <div class="loader-container">
        <div class="loader-bar" id="loaderBar"></div>
    </div>
    
    <p style="margin-top: 20px; opacity: 0.7; font-size: 0.9rem;">Loading Christmas magic...</p>
</div>

<!-- PAGE 2 - HEART TAP -->
<div class="page" id="p2">
    <h2 style="font-size: 2.2rem; color: var(--christmas-red);">üíñ Warm Up Your Heart</h2>
    <p style="margin: 20px 0; font-size: 1.2rem;">Tap the heart 7 times to fill it with Christmas love</p>
    
    <div class="heart-container">
        <div class="heart" onclick="tapHeart()">üíñ</div>
        <div id="tapCount" style="font-size: 1.5rem; margin-top: 20px; background: var(--light-bg); padding: 12px 30px; border-radius: 50px; backdrop-filter: blur(10px);">0 / 7</div>
    </div>
    
    <button class="btn" onclick="skipTap()" id="skipBtn" style="display: none; margin-top: 30px;">Skip to Next</button>
</div>

<!-- PAGE 3 - NAME LOCK -->
<div class="page" id="p3">
    <div class="lock-icon">üîí</div>
    <h2 style="font-size: 2.2rem; color: var(--christmas-blue);">Secret Code</h2>
    <p style="margin: 15px 0; font-size: 1.2rem;">Enter your best friend's name to continue</p>
    <p style="font-size: 0.9rem; opacity: 0.7; margin-bottom: 10px;">(Hint: It's the creator of this magical card)</p>
    
    <input type="text" class="name-input" id="nameInput" placeholder="Type the name here" autocomplete="off">
    <button class="btn" onclick="checkName()">Unlock Magic üóùÔ∏è</button>
    
    <p id="nameHint" style="margin-top: 15px; font-size: 0.9rem; opacity: 0.7; display: none;"></p>
</div>

<!-- PAGE 4 - EMOTION SELECTION -->
<div class="page" id="p4">
    <h2 style="font-size: 2.2rem; color: var(--christmas-gold);">üí≠ How's Your Christmas Mood?</h2>
    <p style="margin: 20px 0; font-size: 1.2rem;">Select how you're feeling this beautiful season</p>
    
    <div class="emotion-buttons">
        <button class="emotion-btn" onclick="setEmotion('happy')">üòä</button>
        <button class="emotion-btn" onclick="setEmotion('excited')">üéâ</button>
        <button class="emotion-btn" onclick="setEmotion('peaceful')">üòå</button>
        <button class="emotion-btn" onclick="setEmotion('loved')">ü•∞</button>
        <button class="emotion-btn" onclick="setEmotion('hopeful')">‚ú®</button>
    </div>
    
    <p id="selectedEmotion" style="margin: 25px 0; font-size: 1.3rem; min-height: 40px; color: var(--christmas-blue);"></p>
    <button class="btn" onclick="proceedAfterEmotion()" id="emotionBtn" style="display: none;">Continue to Message ‚Üí</button>
</div>

<!-- PAGE 5 - SPECIAL MESSAGE WITH SLIDER -->
<div class="page" id="p5">
    <h2 style="font-size: 2.2rem; color: var(--christmas-gold); margin-bottom: 30px;">‚ú® A Special Message Just for You ‚ú®</h2>
    
    <div class="message-slider-container">
        <div class="message-slider" id="messageSlider">
            <div class="typing-text" id="typingText"></div>
        </div>
        
        <div class="slider-controls">
            <button class="slider-btn" onclick="scrollMessage('up')">
                <i class="fas fa-chevron-up"></i>
            </button>
            <button class="slider-btn" onclick="scrollMessage('down')">
                <i class="fas fa-chevron-down"></i>
            </button>
            <button class="slider-btn" onclick="scrollMessage('top')">
                <i class="fas fa-angle-double-up"></i>
            </button>
            <button class="slider-btn" onclick="scrollMessage('bottom')">
                <i class="fas fa-angle-double-down"></i>
            </button>
        </div>
        
        <div class="slider-dots" id="sliderDots"></div>
    </div>
    
    <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.7); font-size: 0.9rem;">
        <i class="fas fa-mouse-pointer"></i> Use scroll wheel or buttons to navigate
    </div>
    
    <button class="btn" onclick="goToPage(6)" style="margin-top: 30px;">Next Challenge ‚Üí</button>
</div>

<!-- PAGE 6 - TIC TAC TOE -->
<div class="page" id="p6">
    <h2 style="font-size: 2.2rem; color: var(--christmas-red); margin-bottom: 10px;">üéÆ Christmas Challenge</h2>
    <p style="margin-bottom: 20px; font-size: 1.2rem;">Win this game to unlock the final Christmas message!</p>
    
    <div class="game-container">
        <div class="board" id="board"></div>
        <div id="gameStatus" style="margin: 25px 0; font-size: 1.3rem; min-height: 40px; color: var(--christmas-gold);">Your turn! Place ‚ùå to start</div>
        
        <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
            <button class="btn" onclick="resetGame()" style="padding: 12px 25px;">üîÑ Restart Game</button>
            <button class="btn" onclick="showHint()" style="padding: 12px 25px;">üí° Get Hint</button>
            <button class="btn" onclick="skipGame()" id="skipGameBtn" style="padding: 12px 25px; display: none;">Skip to Final</button>
        </div>
    </div>
</div>

<!-- PAGE 7 - FINAL MESSAGE WITH ADVANCED SLIDER -->
<div class="page" id="p7">
    <div class="final-message-container">
        <h2 class="final-title">Merry Christmas Diana! üéÑ</h2>
        
        <div class="message-slider-wrapper">
            <div class="message-slides" id="messageSlides">
                <!-- Slide 1 -->
                <div class="message-slide">
                    <div class="message-content">
                        <div class="message-paragraph">
                            <strong>My Dearest Diana,</strong>
                        </div>
                        
                        <div class="message-paragraph">
                            As the snowflakes dance in the winter air and Christmas lights twinkle like distant stars, 
                            I wanted to create something truly special just for you.
                        </div>
                        
                        <div class="message-paragraph">
                            This digital card carries all my warmest wishes for the most wonderful time of the year.
                        </div>
                        
                        <div class="message-paragraph">
                            May your Christmas be filled with laughter that echoes through your home, 
                            love that warms your heart, and moments that become cherished memories.
                        </div>
                    </div>
                </div>
                
                <!-- Slide 2 -->
                <div class="message-slide">
                    <div class="message-content">
                        <div class="message-paragraph">
                            I know this isn't perfect ‚Äì perhaps with more time, it could have been even more magical.
                        </div>
                        
                        <div class="message-paragraph">
                            But every animation, every line of code, and every word was crafted with all my heart.
                        </div>
                        
                        <div class="message-paragraph">
                            I truly wish that everything you desire in life comes true. May your path be filled with joy, 
                            your heart with contentment, and your days with endless smiles.
                        </div>
                        
                        <div class="message-paragraph">
                            May you never face sorrow, and may every challenge become an opportunity for growth.
                        </div>
                    </div>
                </div>
                
                <!-- Slide 3 -->
                <div class="message-slide">
                    <div class="message-content">
                        <div class="message-paragraph">
                            I hope you achieve great success in your studies and shine brightly in every activity you undertake.
                        </div>
                        
                        <div class="message-paragraph">
                            Stay at the top, not because you have to, but because you deserve to be there.
                        </div>
                        
                        <div class="message-paragraph">
                            Always remember to believe in yourself, even when doubts whisper in your ear.
                        </div>
                        
                        <div class="message-paragraph">
                            You are stronger, smarter, and more capable than you know.
                        </div>
                        
                        <div class="signature">
                            With all my heart,<br>
                            <strong style="color: var(--christmas-red);">Your friend Ayaz</strong> üíù
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="advanced-slider-controls">
            <button class="advanced-slider-btn" onclick="prevSlide()">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <div class="slide-indicator">
                <span id="currentSlide">1</span> / <span id="totalSlides">3</span>
            </div>
            
            <button class="advanced-slider-btn" onclick="nextSlide()">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <div class="keyboard-hint">
            <i class="fas fa-keyboard"></i> Use ‚Üê ‚Üí arrow keys to navigate
        </div>
    </div>
    
    <div style="display: flex; gap: 15px; margin-top: 40px;">
        <button class="btn" onclick="restartCard()">üîÑ Experience Again</button>
        <button class="btn" onclick="shareCard()">üì§ Share Christmas Joy</button>
    </div>
</div>

<script>
// ========== GLOBAL VARIABLES ==========
let currentPage = 1;
let heartTaps = 0;
let selectedEmotion = '';
let gameBoard = ['', '', '', '', '', '', '', '', ''];
let currentPlayer = 'X';
let gameActive = true;
let winPatterns = [
    [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows
    [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns
    [0, 4, 8], [2, 4, 6]             // Diagonals
];

// Slider variables
let currentSlide = 0;
const totalSlides = 3;

// Special message lines for page 5
const specialMessage = [
    "Merry Christmas, Diana! üéÑ‚ú®",
    "",
    "I created this page especially for you.",
    "I hope you liked it.",
    "",
    "I know it's not perfect...",
    "Maybe if I had spent a little more time,",
    "It could have been even better.",
    "",
    "But it was made with all my heart.",
    "",
    "I truly wish that everything you desire",
    "in life comes true.",
    "",
    "May you always stay happy, smiling,",
    "and never face any sorrow.",
    "",
    "I hope you achieve great success",
    "in your studies",
    "",
    "And stay at the top in every activity",
    "you take part in.",
    "",
    "Always believe in yourself.",
    "",
    "You deserve the best. üíñ"
];

// ========== INITIALIZATION ==========
window.onload = function() {
    createAnimatedBackground();
    startLoader();
    
    // Initialize music
    const bgMusic = document.getElementById('bgMusic');
    const musicToggle = document.getElementById('musicToggle');
    let musicPlaying = false;
    
    bgMusic.volume = 0.3;
    
    musicToggle.addEventListener('click', function() {
        if (musicPlaying) {
            bgMusic.pause();
            musicToggle.innerHTML = '<i class="fas fa-music"></i>';
        } else {
            bgMusic.play().catch(e => console.log("Audio play prevented by browser"));
            musicToggle.innerHTML = '<i class="fas fa-pause"></i>';
        }
        musicPlaying = !musicPlaying;
    });
    
    // Initialize Tic Tac Toe
    initializeTicTacToe();
    
    // Initialize slider for page 7
    initializeSlider();
    
    // Add keyboard event listener for slider navigation
    document.addEventListener('keydown', handleKeyboardNavigation);
};

// ========== ANIMATED BACKGROUND ==========
function createAnimatedBackground() {
    const bg = document.getElementById('animatedBg');
    const emojis = ['‚ùÑÔ∏è', '‚ú®', 'üéÑ', 'üéÅ', 'üåü', 'üíñ', '‚≠ê', '‚òÉÔ∏è'];
    
    for (let i = 0; i < 50; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
        heart.style.color = ['#ff4d6d', '#ffd700', '#6dd5ed', '#ffffff'][Math.floor(Math.random() * 4)];
        heart.style.animationDuration = (Math.random() * 15 + 10) + 's';
        heart.style.animationDelay = Math.random() * 5 + 's';
        bg.appendChild(heart);
        
        const star = document.createElement('div');
        star.className = 'floating-star';
        star.innerHTML = '‚ú®';
        star.style.left = Math.random() * 100 + 'vw';
        star.style.fontSize = (Math.random() * 15 + 10) + 'px';
        star.style.animationDuration = (Math.random() * 20 + 15) + 's';
        star.style.animationDelay = Math.random() * 3 + 's';
        bg.appendChild(star);
    }
}

// ========== SLIDER FUNCTIONS ==========
function initializeSlider() {
    // Update slide indicators
    document.getElementById('currentSlide').textContent = currentSlide + 1;
    document.getElementById('totalSlides').textContent = totalSlides;
    updateProgressBar();
    
    // Create slider dots for page 5
    createSliderDots();
}

function createSliderDots() {
    const sliderDots = document.getElementById('sliderDots');
    sliderDots.innerHTML = '';
    
    // Create 3 dots for page 5 slider sections
    for (let i = 0; i < 3; i++) {
        const dot = document.createElement('div');
        dot.className = 'slider-dot' + (i === 0 ? ' active' : '');
        dot.onclick = () => scrollToSection(i);
        sliderDots.appendChild(dot);
    }
}

function scrollToSection(sectionIndex) {
    const messageSlider = document.getElementById('messageSlider');
    const sectionHeight = messageSlider.scrollHeight / 3;
    messageSlider.scrollTo({
        top: sectionHeight * sectionIndex,
        behavior: 'smooth'
    });
    
    // Update active dot
    document.querySelectorAll('.slider-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === sectionIndex);
    });
}

function scrollMessage(direction) {
    const messageSlider = document.getElementById('messageSlider');
    const scrollAmount = 100;
    
    switch(direction) {
        case 'up':
            messageSlider.scrollBy({ top: -scrollAmount, behavior: 'smooth' });
            break;
        case 'down':
            messageSlider.scrollBy({ top: scrollAmount, behavior: 'smooth' });
            break;
        case 'top':
            messageSlider.scrollTo({ top: 0, behavior: 'smooth' });
            break;
        case 'bottom':
            messageSlider.scrollTo({ top: messageSlider.scrollHeight, behavior: 'smooth' });
            break;
    }
    
    updateSliderDots();
}

function updateSliderDots() {
    const messageSlider = document.getElementById('messageSlider');
    const sectionHeight = messageSlider.scrollHeight / 3;
    const currentSection = Math.floor(messageSlider.scrollTop / sectionHeight);
    
    document.querySelectorAll('.slider-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSection);
    });
}

// Page 7 Slider Functions
function nextSlide() {
    if (currentSlide < totalSlides - 1) {
        currentSlide++;
        updateSlider();
    }
}

function prevSlide() {
    if (currentSlide > 0) {
        currentSlide--;
        updateSlider();
    }
}

function updateSlider() {
    const messageSlides = document.getElementById('messageSlides');
    const slideWidth = 100 / totalSlides;
    messageSlides.style.transform = `translateX(-${currentSlide * 100}%)`;
    
    // Update indicators
    document.getElementById('currentSlide').textContent = currentSlide + 1;
    updateProgressBar();
    
    // Add slide animation to paragraphs
    const currentSlideElement = document.querySelectorAll('.message-slide')[currentSlide];
    const paragraphs = currentSlideElement.querySelectorAll('.message-paragraph');
    
    paragraphs.forEach((para, index) => {
        para.style.animationDelay = `${index * 0.2}s`;
        para.style.animationName = 'slideInRight';
    });
}

function updateProgressBar() {
    const progress = ((currentSlide + 1) / totalSlides) * 100;
    document.getElementById('progressFill').style.width = `${progress}%`;
}

function handleKeyboardNavigation(e) {
    if (currentPage === 7) {
        switch(e.key) {
            case 'ArrowLeft':
                prevSlide();
                break;
            case 'ArrowRight':
                nextSlide();
                break;
            case 'Home':
                currentSlide = 0;
                updateSlider();
                break;
            case 'End':
                currentSlide = totalSlides - 1;
                updateSlider();
                break;
        }
    }
}

// ========== PAGE NAVIGATION ==========
function goToPage(pageNum) {
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });
    
    // Add celebration effects for final page
    if (pageNum === 7) {
        setTimeout(() => {
            createConfettiBurst();
        }, 500);
        
        // Play celebration sound
        const winSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3');
        winSound.volume = 0.3;
        winSound.play().catch(e => console.log(e));
    }
    
    setTimeout(() => {
        document.getElementById(`p${pageNum}`).classList.add('active');
        currentPage = pageNum;
        
        // Initialize special message if going to page 5
        if (pageNum === 5) {
            startSpecialMessage();
        }
    }, 300);
}

function createConfettiBurst() {
    const colors = ['#ff4d6d', '#ffd700', '#6dd5ed', '#2ecc71', '#ffffff'];
    
    for (let i = 0; i < 150; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.top = '-10px';
        confetti.style.width = Math.random() * 10 + 5 + 'px';
        confetti.style.height = confetti.style.width;
        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        confetti.style.opacity = '1';
        
        document.body.appendChild(confetti);
        
        // Animate confetti
        const angle = Math.random() * Math.PI * 2;
        const velocity = Math.random() * 5 + 2;
        const vx = Math.cos(angle) * velocity;
        const vy = Math.sin(angle) * velocity;
        const gravity = 0.05;
        let posX = parseFloat(confetti.style.left);
        let posY = -10;
        let opacity = 1;
        let rotation = 0;
        
        function animateConfetti() {
            posX += vx;
            posY += vy;
            vy += gravity;
            opacity -= 0.005;
            rotation += 5;
            
            confetti.style.left = posX + 'px';
            confetti.style.top = posY + 'px';
            confetti.style.opacity = opacity;
            confetti.style.transform = `rotate(${rotation}deg)`;
            
            if (opacity > 0 && posY < window.innerHeight) {
                requestAnimationFrame(animateConfetti);
            } else {
                confetti.remove();
            }
        }
        
        requestAnimationFrame(animateConfetti);
    }
}

// ========== PAGE 1 - LOADER ==========
function startLoader() {
    let progress = 0;
    const loaderBar = document.getElementById('loaderBar');
    const interval = setInterval(() => {
        progress += 2;
        loaderBar.style.width = progress + '%';
        
        if (progress >= 100) {
            clearInterval(interval);
            setTimeout(() => {
                goToPage(2);
            }, 800);
        }
    }, 50);
}

// ========== PAGE 2 - HEART TAP ==========
function tapHeart() {
    heartTaps++;
    document.getElementById('tapCount').textContent = `${heartTaps} / 7`;
    
    // Animate heart
    const heart = document.querySelector('.heart');
    heart.style.transform = 'scale(1.3)';
    setTimeout(() => {
        heart.style.transform = 'scale(1)';
    }, 200);
    
    // Create particle effect
    createParticleEffect(heart);
    
    // Show skip button after 3 taps
    if (heartTaps >= 3) {
        document.getElementById('skipBtn').style.display = 'block';
    }
    
    // Proceed after 7 taps
    if (heartTaps >= 7) {
        setTimeout(() => goToPage(3), 1000);
    }
}

function createParticleEffect(element) {
    const rect = element.getBoundingClientRect();
    const x = rect.left + rect.width / 2;
    const y = rect.top + rect.height / 2;
    
    for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'absolute';
        particle.style.width = '8px';
        particle.style.height = '8px';
        particle.style.background = ['#ff4d6d', '#ffd700', '#6dd5ed'][Math.floor(Math.random() * 3)];
        particle.style.borderRadius = '50%';
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.pointerEvents = 'none';
        particle.style.zIndex = '1000';
        
        document.body.appendChild(particle);
        
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 3 + 1;
        const vx = Math.cos(angle) * speed;
        const vy = Math.sin(angle) * speed;
        let opacity = 1;
        
        function animate() {
            opacity -= 0.03;
            particle.style.opacity = opacity;
            particle.style.transform = `translate(${vx * (1 - opacity) * 50}px, ${vy * (1 - opacity) * 50}px)`;
            
            if (opacity > 0) {
                requestAnimationFrame(animate);
            } else {
                particle.remove();
            }
        }
        
        animate();
    }
}

function skipTap() {
    heartTaps = 7;
    document.getElementById('tapCount').textContent = '7 / 7';
    setTimeout(() => goToPage(3), 300);
}

// ========== PAGE 3 - NAME CHECK ==========
function checkName() {
    const nameInput = document.getElementById('nameInput').value.trim().toLowerCase();
    const hint = document.getElementById('nameHint');
    
    if (nameInput === 'ayaz') {
        // Correct name
        hint.textContent = '‚ú® Correct! Welcome Ayaz! ‚ú®';
        hint.style.color = '#2ecc71';
        hint.style.display = 'block';
        
        // Celebration effect
        createParticleEffect(document.querySelector('.lock-icon'));
        
        setTimeout(() => {
            goToPage(4);
        }, 1200);
    } else {
        // Wrong name
        hint.textContent = 'Try again! Hint: It starts with "A" and ends with "z" üòä';
        hint.style.color = '#ff4d6d';
        hint.style.display = 'block';
        
        // Shake animation
        const input = document.getElementById('nameInput');
        input.style.transform = 'translateX(10px)';
        setTimeout(() => input.style.transform = 'translateX(-10px)', 100);
        setTimeout(() => input.style.transform = 'translateX(0)', 200);
        
        // Clear input after delay
        setTimeout(() => {
            document.getElementById('nameInput').value = '';
            document.getElementById('nameInput').focus();
        }, 300);
    }
}

// ========== PAGE 4 - EMOTION SELECTION ==========
function setEmotion(emotion) {
    selectedEmotion = emotion;
    const emotionText = document.getElementById('selectedEmotion');
    const emotionBtn = document.getElementById('emotionBtn');
    
    const messages = {
        happy: "That's wonderful! Let's spread that Christmas joy! üòäüéÑ",
        excited: "Christmas excitement is the best feeling! üéâ‚ú®",
        peaceful: "May peace and serenity fill your heart this season üòåüïäÔ∏è",
        loved: "You are loved more than you know! ü•∞üíñ",
        hopeful: "May all your hopes and dreams come true this year! ‚ú®üåü"
    };
    
    emotionText.textContent = messages[emotion];
    emotionBtn.style.display = 'block';
    
    // Visual feedback
    document.querySelectorAll('.emotion-btn').forEach(btn => {
        btn.style.transform = 'scale(1)';
        btn.style.borderColor = 'transparent';
    });
    event.target.style.transform = 'scale(1.1)';
    event.target.style.borderColor = '#ffd700';
    event.target.style.boxShadow = '0 0 25px rgba(255, 215, 0, 0.4)';
}

function proceedAfterEmotion() {
    goToPage(5);
}

// ========== PAGE 5 - SPECIAL MESSAGE (WITH SLIDER) ==========
function startSpecialMessage() {
    const typingText = document.getElementById('typingText');
    
    typingText.innerHTML = '';
    
    specialMessage.forEach((line, index) => {
        const lineElement = document.createElement('div');
        lineElement.className = 'message-line';
        lineElement.textContent = line || ' ';
        lineElement.style.animationDelay = `${index * 0.1}s`;
        typingText.appendChild(lineElement);
    });
    
    // Add scroll event listener to update dots
    const messageSlider = document.getElementById('messageSlider');
    messageSlider.addEventListener('scroll', updateSliderDots);
}

// ========== PAGE 6 - TIC TAC TOE ==========
function initializeTicTacToe() {
    const board = document.getElementById('board');
    board.innerHTML = '';
    
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.index = i;
        cell.addEventListener('click', () => handleCellClick(i));
        board.appendChild(cell);
    }
}

function handleCellClick(index) {
    if (!gameActive || gameBoard[index] !== '') return;
    
    // Player move
    gameBoard[index] = currentPlayer;
    const cell = document.querySelector(`.cell[data-index="${index}"]`);
    cell.classList.add(currentPlayer.toLowerCase());
    cell.style.cursor = 'default';
    
    if (checkWin()) {
        gameActive = false;
        highlightWinningLine();
        document.getElementById('gameStatus').innerHTML = 'üéâ You win! Unlocking final message...';
        
        setTimeout(() => {
            goToPage(7);
        }, 1500);
        return;
    }
    
    if (checkDraw()) {
        gameActive = false;
        document.getElementById('gameStatus').textContent = "It's a draw! Try again?";
        document.getElementById('skipGameBtn').style.display = 'block';
        return;
    }
    
    // Switch to AI
    currentPlayer = 'O';
    document.getElementById('gameStatus').textContent = "AI's turn... ‚≠ï";
    
    setTimeout(() => {
        makeAIMove();
    }, 800);
}

function makeAIMove() {
    if (!gameActive) return;
    
    // Simple AI logic
    let move;
    
    // Try to win
    move = findWinningMove('O');
    
    // Block player's winning move
    if (move === -1) {
        move = findWinningMove('X');
    }
    
    // Take center if available
    if (move === -1 && gameBoard[4] === '') {
        move = 4;
    }
    
    // Take random corner
    if (move === -1) {
        const corners = [0, 2, 6, 8];
        const availableCorners = corners.filter(i => gameBoard[i] === '');
        if (availableCorners.length > 0) {
            move = availableCorners[Math.floor(Math.random() * availableCorners.length)];
        }
    }
    
    // Take random edge
    if (move === -1) {
        const edges = [1, 3, 5, 7];
        const availableEdges = edges.filter(i => gameBoard[i] === '');
        if (availableEdges.length > 0) {
            move = availableEdges[Math.floor(Math.random() * availableEdges.length)];
        }
    }
    
    if (move !== -1) {
        gameBoard[move] = currentPlayer;
        const cell = document.querySelector(`.cell[data-index="${move}"]`);
        cell.classList.add(currentPlayer.toLowerCase());
        cell.style.cursor = 'default';
        
        if (checkWin()) {
            gameActive = false;
            highlightWinningLine();
            document.getElementById('gameStatus').innerHTML = 'ü§ñ AI wins! Try again?';
            document.getElementById('skipGameBtn').style.display = 'block';
            return;
        }
        
        if (checkDraw()) {
            gameActive = false;
            document.getElementById('gameStatus').textContent = "It's a draw! Try again?";
            document.getElementById('skipGameBtn').style.display = 'block';
            return;
        }
        
        currentPlayer = 'X';
        document.getElementById('gameStatus').textContent = 'Your turn! Place ‚ùå';
    }
}

function findWinningMove(player) {
    for (let pattern of winPatterns) {
        const [a, b, c] = pattern;
        const cells = [gameBoard[a], gameBoard[b], gameBoard[c]];
        
        // Count player's marks
        const playerCount = cells.filter(cell => cell === player).length;
        const emptyCount = cells.filter(cell => cell === '').length;
        
        if (playerCount === 2 && emptyCount === 1) {
            if (gameBoard[a] === '') return a;
            if (gameBoard[b] === '') return b;
            if (gameBoard[c] === '') return c;
        }
    }
    return -1;
}

function checkWin() {
    for (let pattern of winPatterns) {
        const [a, b, c] = pattern;
        if (gameBoard[a] && gameBoard[a] === gameBoard[b] && gameBoard[a] === gameBoard[c]) {
            return true;
        }
    }
    return false;
}

function checkDraw() {
    return gameBoard.every(cell => cell !== '');
}

function highlightWinningLine() {
    for (let pattern of winPatterns) {
        const [a, b, c] = pattern;
        if (gameBoard[a] && gameBoard[a] === gameBoard[b] && gameBoard[a] === gameBoard[c]) {
            const cells = document.querySelectorAll('.cell');
            cells[a].style.background = 'rgba(255, 215, 0, 0.3)';
            cells[b].style.background = 'rgba(255, 215, 0, 0.3)';
            cells[c].style.background = 'rgba(255, 215, 0, 0.3)';
            break;
        }
    }
}

function resetGame() {
    gameBoard = ['', '', '', '', '', '', '', '', ''];
    currentPlayer = 'X';
    gameActive = true;
    
    document.querySelectorAll('.cell').forEach(cell => {
        cell.className = 'cell';
        cell.style.background = '';
        cell.style.cursor = 'pointer';
        cell.addEventListener('click', (e) => {
            const index = parseInt(e.target.dataset.index);
            handleCellClick(index);
        });
    });
    
    document.getElementById('gameStatus').textContent = 'Your turn! Place ‚ùå to start';
    document.getElementById('skipGameBtn').style.display = 'none';
}

function showHint() {
    if (!gameActive || currentPlayer !== 'X') return;
    
    const hint = findWinningMove('X');
    if (hint !== -1) {
        const cell = document.querySelector(`.cell[data-index="${hint}"]`);
        cell.style.boxShadow = '0 0 25px gold, 0 0 35px gold';
        setTimeout(() => {
            cell.style.boxShadow = 'none';
        }, 1200);
    }
}

function skipGame() {
    goToPage(7);
}

// ========== PAGE 7 - FINAL ==========
function restartCard() {
    // Reset all variables
    heartTaps = 0;
    selectedEmotion = '';
    gameBoard = ['', '', '', '', '', '', '', '', ''];
    currentPlayer = 'X';
    gameActive = true;
    currentSlide = 0;
    
    // Reset UI elements
    document.getElementById('tapCount').textContent = '0 / 7';
    document.getElementById('nameInput').value = '';
    document.getElementById('selectedEmotion').textContent = '';
    document.getElementById('typingText').innerHTML = '';
    
    // Reset game
    resetGame();
    
    // Reset slider
    updateSlider();
    
    // Go back to first page
    goToPage(1);
    
    // Restart loader
    setTimeout(() => {
        const loaderBar = document.getElementById('loaderBar');
        loaderBar.style.width = '0%';
        
        let progress = 0;
        const interval = setInterval(() => {
            progress += 2;
            loaderBar.style.width = progress + '%';
            
            if (progress >= 100) {
                clearInterval(interval);
                setTimeout(() => goToPage(2), 800);
            }
        }, 50);
    }, 300);
}

function shareCard() {
    if (navigator.share) {
        navigator.share({
            title: 'Merry Christmas Diana!',
            text: 'Check out this beautiful Christmas card made specially for Diana!',
            url: window.location.href
        });
    } else {
        alert('Share this special Christmas card with your friends! üéÑ‚ú®');
    }
}

// ========== KEYBOARD SHORTCUTS ==========
document.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowRight' && currentPage < 7) {
        if (currentPage !== 7) goToPage(currentPage + 1);
    } else if (e.key === 'ArrowLeft' && currentPage > 1) {
        goToPage(currentPage - 1);
    } else if (e.key === 'Escape') {
        const musicToggle = document.getElementById('musicToggle');
        musicToggle.click();
    }
});
</script>
</body>
</html>